name: xls-to-xlsx

# Controls when the action will run. 
on:
# Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:
    branches:
    - main

jobs:
  build:
    runs-on:  windows-2019


    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
        with:
          lfs: 'true'
          
      - name: pwd & ls
        run: |
          pwd
          ls
          
      - name: Install Office
        run: choco install office365business
          
      - name: Convert XLS file
        run: |
          Add-Type -AssemblyName Microsoft.Office.Interop.Excel
          $xlFixedFormat = [Microsoft.Office.Interop.Excel.XlFileFormat]::xlOpenXMLWorkbook
          write-host $xlFixedFormat
          $excel = New-Object -ComObject excel.application
          $excel.visible = $true
          $filetype ="*xls"
          $workbook = $excel.workbooks.open("D:\a\xls-xlsx-conversion\xls-xlsx-conversion\data\The Products.xls")
          $path += ".xlsx"
          $workbook.saveas($path, $xlFixedFormat)
          $workbook.close()
          $excel.Quit()
          $excel = $null
          [gc]::collect()
          [gc]::WaitForPendingFinalizers()
        shell: powershell
        
      - name: ls data
        run: |
          ls .\data\
          
          
        
           
      #- name: Install Office
      #  run: choco install office365business
